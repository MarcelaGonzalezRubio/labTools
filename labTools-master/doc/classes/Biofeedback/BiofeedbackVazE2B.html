<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of BiofeedbackVazE2B</title>
  <meta name="keywords" content="BiofeedbackVazE2B">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">classes</a> &gt; <a href="index.html">Biofeedback</a> &gt; BiofeedbackVazE2B.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for classes/Biofeedback&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>BiofeedbackVazE2B
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="BiofeedbackVazE2B.html" class="code" title="">BiofeedbackVazE2B</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="BiofeedbackVazE2B.html" class="code" title="">BiofeedbackVazE2B</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function this=BiofeedbackVazE2B(ID,date,day,sex,dob,dleg,dhand,height,weight,age,triallist)</a></li><li><a href="#_sub2" class="code">function []=AnalyzePerformance(this)</a></li><li><a href="#_sub3" class="code">function []=editTriallist(this)</a></li><li><a href="#_sub4" class="code">function []=saveit(this)</a></li><li><a href="#_sub5" class="code">function []=comparedays(this,flag)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="BiofeedbackVazE2B.html" class="code" title="">BiofeedbackVazE2B</a>
0002     <span class="comment">%Class BiofeedbackVazE2B houses metadata and methods to process</span>
0003     <span class="comment">%Vazquez's Experiment 2B</span>
0004     <span class="comment">%biofeedback trials</span>
0005     <span class="comment">%</span>
0006     <span class="comment">%Properties:</span>
0007     <span class="comment">%</span>
0008     <span class="comment">%   subjectcode = '' string containing subject code, e.g. 'SLP001'</span>
0009     <span class="comment">%   date=''  Date of the experiment, lab date object</span>
0010     <span class="comment">%   day='' string that indicates day1 or day2 testing</span>
0011     <span class="comment">%   sex = '' string designates subject sex e.g. 'f'</span>
0012     <span class="comment">%   dob='' lab date object with date of birth</span>
0013     <span class="comment">%   dominantleg='' string designate dominant leg, e.g. 'r'</span>
0014     <span class="comment">%   dominanthand = '' string designate dominant hand e.g. 'r'</span>
0015     <span class="comment">%   height=[];  cm</span>
0016     <span class="comment">%   weight=[];  kg</span>
0017     <span class="comment">%   age=[];  years</span>
0018     <span class="comment">%</span>
0019     <span class="comment">%   triallist={};  cell array of trial #'s, filenames, and type of</span>
0020     <span class="comment">%                   trial. construct instance with blank cell, can input data using a</span>
0021     <span class="comment">%                   method instead of copying and pasting into inputs</span>
0022     <span class="comment">%</span>
0023     <span class="comment">%   Rtmtarget=[]; right leg step length target as determined by treadmill baseline</span>
0024     <span class="comment">%</span>
0025     <span class="comment">%   Ltmtarget=[]; left leg step length target as determined by treadmill baseline</span>
0026     <span class="comment">%</span>
0027     <span class="comment">%   OGsteplength=[]; step length target as determined by over-ground walking</span>
0028     <span class="comment">%</span>
0029     <span class="comment">%    OGspeed=[]; average speed of subject during the OG trial to determine OG steplength</span>
0030     <span class="comment">%</span>
0031     <span class="comment">%Methods:</span>
0032     <span class="comment">%</span>
0033     <span class="comment">%   AnalyzePerformance(flag) -- computes step length errors for each</span>
0034     <span class="comment">%                               biofeedback trial,</span>
0035     <span class="comment">%</span>
0036     <span class="comment">%   editTriallist() -- select filenames, edit trial #'s and type and</span>
0037     <span class="comment">%                      category, input num is the # of trials, or rows in the list</span>
0038     <span class="comment">%</span>
0039     <span class="comment">%   saveit() -- saves the instance with filename equal to the ID</span>
0040     <span class="comment">%</span>
0041     <span class="comment">%   comparedays() -- makes bar plots comparing day1 and day2</span>
0042 
0043     
0044     properties
0045         subjectcode = <span class="string">''</span>
0046         date=<span class="string">''</span>
0047         day=<span class="string">''</span>
0048         sex = <span class="string">''</span>
0049         dob=<span class="string">''</span>
0050         dominantleg=<span class="string">''</span>
0051         dominanthand = <span class="string">''</span>
0052         height=[];
0053         weight=[];
0054         age=[];
0055         triallist={};
0056         datalocation=pwd;
0057         data={};
0058         dataheader={};
0059         
0060         
0061     <span class="keyword">end</span>
0062     
0063     methods
0064         <span class="comment">%constuctor</span>
0065         <a name="_sub0" href="#_subfunctions" class="code">function this=BiofeedbackVazE2B(ID,date,day,sex,dob,dleg,dhand,height,weight,age,triallist)</a>
0066         
0067             <span class="keyword">if</span> nargin ~= 11
0068 <span class="comment">%                 disp('Error, incorrect # of input arguments provided');</span>
0069                 cprintf(<span class="string">'err'</span>,<span class="string">'Error: incorrect # of input arguments provided\n'</span>);
0070             <span class="keyword">else</span>
0071                 
0072                 <span class="keyword">if</span> ischar(ID)
0073                     this.subjectcode=ID;
0074                 <span class="keyword">else</span>
0075                     this.subjectcode=<span class="string">''</span>;
0076                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: invalid subject ID input, must be a string\n'</span>);
0077                 <span class="keyword">end</span>
0078                 
0079                 <span class="keyword">if</span> isa(date,<span class="string">'labDate'</span>)
0080                     this.date = date;
0081                 <span class="keyword">else</span>
0082                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: incorrect experiment date format provided, must be class labDate\n'</span>);
0083                     this.date=<span class="string">''</span>;
0084                 <span class="keyword">end</span>
0085                 
0086                 <span class="keyword">if</span> isnumeric(day)
0087                     this.day = day;
0088                 <span class="keyword">else</span>
0089                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: input for day must be a number\n'</span>);
0090                     this.day=<span class="string">''</span>;
0091                 <span class="keyword">end</span>
0092                     
0093                 <span class="keyword">if</span> ischar(sex)
0094                     this.sex = sex;
0095                 <span class="keyword">else</span>
0096                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: input for sex must be a string\n'</span>);
0097                     this.sex=<span class="string">''</span>;
0098                 <span class="keyword">end</span>
0099                 
0100                 <span class="keyword">if</span> isa(dob,<span class="string">'labDate'</span>)
0101                     this.dob=dob;
0102                 <span class="keyword">else</span>
0103                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: date of birth is not the correct format\n'</span>);
0104                     this.dob=[];
0105                 <span class="keyword">end</span>
0106                 
0107                 <span class="keyword">if</span> ischar(dleg)
0108                     this.dominantleg=dleg;
0109                 <span class="keyword">else</span>
0110                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: incorrect format for dominant leg input, must be a string\n'</span>);
0111                     this.dominantleg=<span class="string">''</span>;
0112                 <span class="keyword">end</span>
0113                 
0114                 <span class="keyword">if</span> ischar(dhand)
0115                     this.dominanthand=dhand;
0116                 <span class="keyword">else</span>
0117                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: incorrect format for dominant hand input, must be a string\n'</span>);
0118                     this.dominanthand=<span class="string">''</span>;
0119                 <span class="keyword">end</span>
0120                 
0121                 <span class="keyword">if</span> isnumeric(height)
0122                     this.height = height;
0123                 <span class="keyword">else</span>
0124                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: input height is not numeric\n'</span>);
0125                     this.height=[];
0126                 <span class="keyword">end</span>
0127                 
0128                 <span class="keyword">if</span> isnumeric(weight)
0129                     this.weight = weight;
0130                 <span class="keyword">else</span>
0131                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: input weight is not numeric\n'</span>);
0132                     this.weight=[];
0133                 <span class="keyword">end</span>
0134                 
0135                 <span class="keyword">if</span> isa(age,<span class="string">'labDate'</span>)
0136                     this.age = age;
0137                 <span class="keyword">else</span>
0138                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: input weight is not class labDate\n'</span>);
0139                     this.age=[];
0140                 <span class="keyword">end</span>
0141                 
0142                 <span class="keyword">if</span> iscell(triallist)
0143                     this.triallist=triallist;
0144                 <span class="keyword">else</span>
0145                     cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: triallist input is not a cell format.\n'</span>);
0146                     this.triallist={};
0147                 <span class="keyword">end</span>
0148                 
0149             <span class="keyword">end</span>
0150 
0151             
0152             
0153         <span class="keyword">end</span>
0154         
0155         <a name="_sub1" href="#_subfunctions" class="code">function []=AnalyzePerformance(this)</a>
0156             <span class="comment">%compute step length error for each trial, uses instance</span>
0157             <span class="comment">%defined target values and the default tolerance of 0.0375 m</span>
0158             <span class="comment">%</span>
0159             <span class="comment">%auto-saves the results</span>
0160 
0161             <span class="keyword">global</span> hits
0162 <span class="comment">%             global lhits</span>
0163             
0164             <span class="keyword">if</span> isempty(this.triallist)
0165                 cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: no trial information available to analyze'</span>);
0166             <span class="keyword">else</span>
0167                filename = this.triallist(:,1);
0168 
0169                <span class="keyword">if</span> iscell(filename)<span class="comment">%if more than one file is selected for analysis</span>
0170 
0171                    hits = {0};
0172                    lhits = {0};
0173                    anks = {0};
0174                    lqrs = {0};
0175                    llqr = {0};
0176                    WB = waitbar(0,<span class="string">'Processing Trials...'</span>);
0177                    <span class="keyword">for</span> z = 1:length(filename)
0178                        tempname = filename{z};
0179                        waitbar((z-1)/length(filename),WB,[<span class="string">'Processing Trial '</span> num2str(z)]);
0180                        <span class="keyword">if</span> strcmp(tempname(end-5:end-4),<span class="string">'V2'</span>) || strcmp(tempname(end-5:end-4),<span class="string">'V3'</span>) || strcmp(tempname(end-5:end-4),<span class="string">'V5'</span>) || strcmp(tempname(end-10:end-9),<span class="string">'V3'</span>) || strcmp(tempname(end-10:end-9),<span class="string">'V5'</span>)
0181                            color{z} = <span class="string">'blue'</span>;
0182                        <span class="keyword">elseif</span> strcmp(tempname(end-10:end-4),<span class="string">'rev12V1'</span>)
0183                            color{z} = <span class="string">'yellow'</span>;
0184                        <span class="keyword">else</span>
0185                            color{z} = <span class="string">'red'</span>;
0186                        <span class="keyword">end</span>
0187                        
0188                        <span class="comment">%check to see if data is already processed, it will</span>
0189                        <span class="comment">%save time...</span>
0190                        <span class="keyword">if</span> length(this.data)&lt;z
0191                            disp(<span class="string">'Parsing data...'</span>);
0192                            [header,data] = JSONtxt2cell(filename{z});
0193                            
0194                            this.data{z} = data;
0195                            this.dataheader = header;
0196                            
0197                        <span class="keyword">else</span>
0198                            data = cell2mat(this.data(z));
0199                            header = this.dataheader;
0200                        <span class="keyword">end</span>
0201                        [~,n] = size(data);
0202 <span class="comment">%                        keyboard</span>
0203                        data2 = unique(data,<span class="string">'rows'</span>,<span class="string">'stable'</span>);<span class="comment">%remove duplicate frames</span>
0204                        data2(:,1) = data2(:,1)-data2(1,1)+1;<span class="comment">%set frame # to start at 1</span>
0205                        
0206                        <span class="comment">%check for monotonicity</span>
0207                        checkers = find(diff(data2(:,1))&lt;1);
0208                        <span class="keyword">while</span> ~isempty(checkers)
0209                            <span class="keyword">for</span> y=1:length(checkers)
0210                                data2(checkers(y),:)=[];
0211                            <span class="keyword">end</span>
0212                            checkers = find(diff(data2(:,1))&lt;1);
0213                        <span class="keyword">end</span>
0214 <span class="comment">%                        keyboard</span>
0215                        <span class="keyword">for</span> zz = 1:n
0216                            data3(data2(:,1),zz) = data2(:,zz);
0217                        <span class="keyword">end</span>
0218                        frame = data3(:,1);
0219                        frame2 = 1:1:data2(<span class="keyword">end</span>,1);
0220 <span class="comment">%                        keyboard</span>
0221                        Rz2 = interp1(data2(:,1),data2(:,2),frame2,<span class="string">'linear'</span>);
0222                        Lz2 = interp1(data2(:,1),data2(:,3),frame2,<span class="string">'linear'</span>);
0223                        Rgamma2 = interp1(data2(:,1),data2(:,8),frame2,<span class="string">'linear'</span>);
0224                        Lgamma2 = interp1(data2(:,1),data2(:,9),frame2,<span class="string">'linear'</span>);
0225                        ank = interp1(data2(:,1),data2(:,13)-data2(:,12),frame2,<span class="string">'linear'</span>);
0226 
0227                        
0228 <span class="comment">%                        ank =</span>
0229                        
0230                        <span class="comment">%detect HS</span>
0231                        <span class="keyword">for</span> zz = 1:length(Rz2)-1
0232                            <span class="keyword">if</span> Rz2(zz) &gt; -30 &amp;&amp; Rz2(zz+1) &lt;= -30
0233                                RHS(zz) = 1;
0234                            <span class="keyword">else</span>
0235                                RHS(zz) = 0;
0236                            <span class="keyword">end</span>
0237                        <span class="keyword">end</span>
0238                        <span class="comment">%detect TO</span>
0239                        <span class="keyword">for</span> zz = 1:length(Rz2)-1
0240                            <span class="keyword">if</span> Rz2(zz) &lt; -30 &amp;&amp; Rz2(zz+1) &gt;= -30
0241                                RTO(zz) = 1;
0242                            <span class="keyword">else</span>
0243                                RTO(zz) = 0;
0244                            <span class="keyword">end</span>
0245                        <span class="keyword">end</span>
0246                        
0247                        [~,trhs] = findpeaks(RHS,<span class="string">'MinPeakDistance'</span>,100);
0248                        [~,trto] = findpeaks(RTO,<span class="string">'MinPeakDistance'</span>,100);
0249                        RHS = zeros(length(RHS),1);
0250                        RHS(trhs) = 1;
0251                        RTO = zeros(length(RTO),1);
0252                        RTO(trhs) = 1;
0253                        
0254                        <span class="keyword">for</span> zz = 1:length(Lz2)-1
0255                            <span class="keyword">if</span> Lz2(zz) &gt; -30 &amp;&amp; Lz2(zz+1) &lt;= -30
0256                                LHS(zz) = 1;
0257                            <span class="keyword">else</span>
0258                                LHS(zz) = 0;
0259                            <span class="keyword">end</span>
0260                        <span class="keyword">end</span>
0261                        <span class="comment">%detect TO</span>
0262                        <span class="keyword">for</span> zz = 1:length(Lz2)-1
0263                            <span class="keyword">if</span> Lz2(zz) &lt; -30 &amp;&amp; Lz2(zz+1) &gt;= -30
0264                                LTO(zz) = 1;
0265                            <span class="keyword">else</span>
0266                                LTO(zz) = 0;
0267                            <span class="keyword">end</span>
0268                        <span class="keyword">end</span>
0269                        
0270                        
0271                        [~,tlhs] = findpeaks(LHS,<span class="string">'MinPeakDistance'</span>,100);
0272                        [~,tlto] = findpeaks(LTO,<span class="string">'MinPeakDistance'</span>,100);
0273                        LHS = zeros(length(LHS),1);
0274                        LHS(tlhs) = 1;
0275                        LTO = zeros(length(LTO),1);
0276                        LTO(tlto) = 1;
0277                        
0278                        [~,trg3] = findpeaks(Rgamma2,<span class="string">'MinPeakHeight'</span>,0.1,<span class="string">'MinPeakDistance'</span>,500);
0279                        RHS = zeros(length(RHS),1);
0280                        RHS(trg3)=1;
0281                        [~,tlg3] = findpeaks(Lgamma2,<span class="string">'MinPeakHeight'</span>,0.1,<span class="string">'MinPeakDistance'</span>,500);
0282                        LHS = zeros(length(LHS),1);
0283                        LHS(tlg3)=1;
0284                        
0285 <span class="comment">%                        figure(60)</span>
0286 <span class="comment">%                        plot(Rgamma2);</span>
0287 <span class="comment">%                        hold on</span>
0288 <span class="comment">%                        scatter(trhs,Rgamma2(trhs),'o','MarkerFaceColor','green');</span>
0289                     
0290 <span class="comment">%                        keyboard</span>
0291                        <span class="comment">%%!!!!!!!!!!!!!!!!!!!!!!!%%!!!!!!!!!!!!!!!!!%%%!!!!!!!!!!!!!!!!</span>
0292                        <span class="comment">%calculate errors</span>
0293                        smallest = min([length(Rgamma2(find(RHS))) length(Lgamma2(find(LHS)))]);
0294                        Rgamma3 = abs(Rgamma2(find(RHS)));
0295                        Lgamma3 = abs(Lgamma2(find(LHS)));
0296                        
0297                        
0298 <span class="comment">%                        keyboard</span>
0299                        tamp = Rgamma3(1:smallest)'-Lgamma3(1:smallest)';
0300                        tamp2 = Lgamma3(1:smallest)'-Rgamma3(1:smallest)';
0301                        tamp3 = ank(find(RHS)-100);
0302 <span class="comment">%                        tamp2 = abs(Lgamma2(find(LHS)))'-this.Ltmtarget;</span>
0303                        
0304                        tamp(abs(tamp)&gt;0.15)=[];<span class="comment">%remove spurios errors</span>
0305                        tamp2(abs(tamp2)&gt;0.15)=[];
0306                        
0307 <span class="comment">%                        g = figure(60)</span>
0308 <span class="comment">%                        subplot(3,1,1)</span>
0309 <span class="comment">%                        plot(Rgamma2);</span>
0310 <span class="comment">%                        hold on</span>
0311 <span class="comment">% %                        plot(Lgamma2-Rgamma2,'r');</span>
0312 <span class="comment">%                        scatter(find(RHS),Rgamma2(find(RHS)),'o','MarkerFaceColor','green');</span>
0313 <span class="comment">%                        subplot(3,1,2)</span>
0314 <span class="comment">%                        plot(Lgamma2);</span>
0315 <span class="comment">%                        hold on</span>
0316 <span class="comment">% %                        plot(Lgamma2-Rgamma2,'r');</span>
0317 <span class="comment">%                        scatter(find(LHS),Lgamma2(find(LHS)),'o','MarkerFaceColor','green');</span>
0318 <span class="comment">%                        subplot(3,1,3)</span>
0319 <span class="comment">%                        plot(Rgamma2(find(RHS)),'r');</span>
0320 <span class="comment">%                        hold on</span>
0321 <span class="comment">%                        plot(Lgamma2(find(LHS)),'g');</span>
0322 
0323 
0324 <span class="comment">%                         g = figure(61)</span>
0325 <span class="comment">%                         subplot(2,1,1)</span>
0326 <span class="comment">%                         plot(Rgamma2);</span>
0327 <span class="comment">%                         hold on</span>
0328 <span class="comment">%                         plot(ank,'r');</span>
0329 <span class="comment">%                         scatter(find(RHS),ank(find(RHS)),'o','MarkerFaceColor','green');</span>
0330 <span class="comment">%                         scatter(find(RHS)-100,ank(find(RHS)-100),'o','MarkerFaceColor','black');</span>
0331 <span class="comment">%                         subplot(2,1,2)</span>
0332 <span class="comment">%                         plot(Lgamma2);</span>
0333 <span class="comment">%                         hold on</span>
0334 <span class="comment">%                         plot(ank,'r');</span>
0335 <span class="comment">%                         scatter(find(LTO),ank(find(LTO)),'o','MarkerFaceColor','green');</span>
0336 <span class="comment">%</span>
0337 <span class="comment">%                         keyboard</span>
0338 <span class="comment">%                         close(g)</span>
0339                        
0340 <span class="comment">%                        tamp(tamp&lt;0) = [];</span>
0341 <span class="comment">%                        tamp2(tamp2&lt;0) = [];</span>
0342                        
0343                        hits{z} = tamp2;
0344                        lhits{z} = tamp;
0345                        anks{z} = tamp3;
0346                        
0347                        lqrs{z} = iqr(hits{z});
0348                        llqr{z} = iqr(lhits{z});
0349                         clear RHS LHS tamp
0350                    <span class="keyword">end</span>
0351                    
0352                    this.saveit();
0353                    
0354                    waitbar(1,WB,<span class="string">'Processing complete...'</span>);
0355                    pause(0.5);
0356                    close(WB);
0357                    clear z
0358                    
0359                    <span class="comment">%load triallist to look for categories</span>
0360                    tlist = this.triallist;
0361                    
0362                    train = find(strcmp(tlist(:,4),<span class="string">'training'</span>));<span class="comment">%logicals of where training trials are</span>
0363                    base = find(strcmp(tlist(:,4),<span class="string">'baseline'</span>));
0364                    adapt = find(strcmp(tlist(:,4),<span class="string">'post-adaptation'</span>));
0365                    wash = find(strcmp(tlist(:,4),<span class="string">'washout'</span>));
0366                    
0367                    figure(2)
0368 <span class="comment">%                    subplot(2,1,1)</span>
0369                    hold on
0370 <span class="comment">%                    keyboard</span>
0371                    fill([0 length(cell2mat(hits(train)')) length(cell2mat(hits(train)')) 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0372                    fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0373                    
0374                    <span class="comment">%add baseline walking bars</span>
0375                    <span class="keyword">for</span> b=1<span class="comment">%:length(base)</span>
0376                        fill([length(cell2mat(hits(train)'))-0.5 length(cell2mat(hits(train)'))+0.5 length(cell2mat(hits(train)'))+0.5 length(cell2mat(hits(train)'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0377                        text(length(cell2mat(hits(train)')),0.125,<span class="string">'Base'</span>);
0378                    <span class="keyword">end</span>
0379                    
0380                    <span class="comment">%add adaptation walking bars</span>
0381                    <span class="keyword">for</span> a=1<span class="comment">%:2:length(adapt)</span>
0382                        fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0383                        text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)')),0.125,<span class="string">'Split'</span>);
0384                    <span class="keyword">end</span>
0385                    
0386                    <span class="comment">%add washout walking bars</span>
0387                    <span class="keyword">for</span> w=1:length(wash)
0388                        <span class="keyword">if</span> w==1
0389                            fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0390                            text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')),0.125,<span class="string">'Wash'</span>);
0391                        <span class="keyword">else</span>
0392                            fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0393                            text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))')),0.125,<span class="string">'Wash'</span>);
0394                        <span class="keyword">end</span>
0395                    <span class="keyword">end</span>
0396                    
0397                    
0398                    h = 0;
0399                    <span class="keyword">for</span> z = 1:length(filename)
0400                        figure(2)
0401 <span class="comment">%                        subplot(2,1,1)</span>
0402                        hold on
0403                        scatter([1:length(hits{z})]+h,hits{z},75,color{z},<span class="string">'fill'</span>);
0404                        plot([h h+length(hits{z})],[0.01 0.01],<span class="string">'k'</span>);<span class="comment">%tolerance lines</span>
0405                        plot([h h+length(hits{z})],[-0.01 -0.01],<span class="string">'k'</span>);
0406                        plot([h h+length(hits{z})],[nanmean(hits{z})+lqrs{z}/2 nanmean(hits{z})+lqrs{z}/2],<span class="string">'Color'</span>,[0.5 0 0.5],<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0407                        plot([h h+length(hits{z})],[nanmean(hits{z})-lqrs{z}/2 nanmean(hits{z})-lqrs{z}/2],<span class="string">'Color'</span>,[0.5 0 0.5],<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0408                        h = h+length(hits{z});
0409                    <span class="keyword">end</span>
0410                    figure(2)
0411 <span class="comment">%                    subplot(2,1,1)</span>
0412                    ylim([-0.15 0.15]);
0413                    xlim([0 h+10]);
0414                    title([this.subjectcode <span class="string">' Step Length Asymmetry Error'</span>]);
0415                    xlabel(<span class="string">'step #'</span>);
0416                    ylabel(<span class="string">'Error (m)'</span>);
0417 
0418 <span class="comment">%                    figure(2)</span>
0419 <span class="comment">%                    subplot(2,1,2)</span>
0420 <span class="comment">%                    hold on</span>
0421 <span class="comment">%                    fill([0 length(cell2mat(lhits(train)')) length(cell2mat(lhits(train)')) 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0422 <span class="comment">%                    fill([length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)')) length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)')) length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)')) length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0423 <span class="comment">%</span>
0424 <span class="comment">%                    %add baseline walking bars</span>
0425 <span class="comment">%                    for b=1:2:length(base)</span>
0426 <span class="comment">%                        fill([length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base(1:b))'))-0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base(1:b))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base(1:b))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base(1:b))'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0427 <span class="comment">%                        text(length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base(1:b))')),0.125,'Base');</span>
0428 <span class="comment">%                    end</span>
0429 <span class="comment">%</span>
0430 <span class="comment">%                    %add adaptation walking bars</span>
0431 <span class="comment">%                    for a=1:2:length(adapt)</span>
0432 <span class="comment">%                        fill([length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt(1:a))'))-0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt(1:a))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt(1:a))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt(1:a))'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0433 <span class="comment">%                        text(length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt(1:a))')),0.125,'Split');</span>
0434 <span class="comment">%                    end</span>
0435 <span class="comment">%</span>
0436 <span class="comment">%                    %add washout walking bars</span>
0437 <span class="comment">%                    for w=1:2:length(wash)</span>
0438 <span class="comment">%                        fill([length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)'))+length(cell2mat(lhits(wash(1:w))'))-0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)'))+length(cell2mat(lhits(wash(1:w))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)'))+length(cell2mat(lhits(wash(1:w))'))+0.5 length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)'))+length(cell2mat(lhits(wash(1:w))'))-0.5],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0439 <span class="comment">%                        text(length(cell2mat(lhits(train)'))+length(cell2mat(lhits(base)'))+length(cell2mat(lhits(adapt)'))+length(cell2mat(lhits(wash(1:w))')),0.125,'Wash');</span>
0440 <span class="comment">%                    end</span>
0441 <span class="comment">%</span>
0442 <span class="comment">%                    h = 0;</span>
0443 <span class="comment">%                    for z = 1:length(filename)</span>
0444 <span class="comment">%                        figure(2)</span>
0445 <span class="comment">%                        subplot(2,1,2)</span>
0446 <span class="comment">%                        scatter([1:length(lhits{z})]+h,lhits{z},75,color{z},'fill');</span>
0447 <span class="comment">%                        plot([h h+length(lhits{z})],[0.0375 0.0375],'k');%tolerance lines</span>
0448 <span class="comment">%                        plot([h h+length(lhits{z})],[-0.0375 -0.0375],'k');</span>
0449 <span class="comment">%                        plot([h h+length(lhits{z})],[nanmean(lhits{z})+llqr{z}/2 nanmean(lhits{z})+llqr{z}/2],'Color',[0.5 0 0.5],'LineWidth',2);%tolerance lines</span>
0450 <span class="comment">%                        plot([h h+length(lhits{z})],[nanmean(lhits{z})-llqr{z}/2 nanmean(lhits{z})-llqr{z}/2],'Color',[0.5 0 0.5],'LineWidth',2);%tolerance lines</span>
0451 <span class="comment">%                        h = h+length(lhits{z});</span>
0452                        <span class="comment">%         h = h+length(lhits{z});</span>
0453 <span class="comment">%                    end</span>
0454 <span class="comment">%                    figure(2)</span>
0455 <span class="comment">%                    subplot(2,1,2)</span>
0456 <span class="comment">%                    ylim([-0.15 0.15]);</span>
0457 <span class="comment">%                    xlim([0 h+10]);</span>
0458 <span class="comment">%                    title([this.subjectcode ' Step Length Error Slow Leg']);</span>
0459 <span class="comment">%                    xlabel('step #');</span>
0460 <span class="comment">%                    ylabel('Error (m)');</span>
0461                    
0462                    
0463 <span class="comment">%                     keyboard</span>
0464                    <span class="keyword">for</span> z=1:length(hits)
0465                        temp = hits{z};
0466                        temp(abs(temp) &gt; 0.1) = [];
0467                        meanhits1(z) = mean(temp);
0468                        stdhits1(z) = std(temp);
0469 <span class="comment">%                        keyboard</span>
0470                        rscore(z) = length(temp(abs(temp)&lt;0.01))/length(temp);
0471 <span class="comment">%                        meanhits2(z) = mean(temp(end-2:end));</span>
0472 <span class="comment">%                        stdhits2(z) = std(temp(end-2:end));</span>
0473                    <span class="keyword">end</span>
0474 <span class="comment">%                    for z=1:length(lhits)</span>
0475 <span class="comment">%                        temp = lhits{z};</span>
0476 <span class="comment">%                        temp(abs(temp) &gt; 0.1) = [];</span>
0477 <span class="comment">%                        meanlhits1(z) = mean(temp);</span>
0478 <span class="comment">%                        stdlhits1(z) = std(temp);</span>
0479 <span class="comment">%                        lscore(z) = length(temp(abs(temp)&lt;0.0375))/length(temp);</span>
0480 <span class="comment">%                        meanlhits2(z) = mean(temp(end-2:end));</span>
0481 <span class="comment">%                        stdlhits2(z) = std(temp(end-2:end));</span>
0482 <span class="comment">%                    end</span>
0483                    
0484                    figure(5)
0485 <span class="comment">%                    subplot(2,1,1)</span>
0486                    hold on
0487                    fill([0 length(train)+0.5 length(train)+0.5 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0488                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0489                    
0490                    <span class="comment">%add baseline bars</span>
0491                    <span class="keyword">for</span> b=1<span class="comment">%:2:length(base)</span>
0492                        fill([length(train)+0.45 length(train)+0.55 length(train)+0.55 length(train)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0493                        text(length(train)+0.45,0.125,<span class="string">'Base'</span>);
0494                    <span class="keyword">end</span>
0495                    
0496                    <span class="comment">%add adaptation bars</span>
0497                    <span class="keyword">for</span> a=1<span class="comment">%:2:length(adapt)</span>
0498                        fill([length(train)+length(base)+0.45 length(train)+length(base)+0.55 length(train)+length(base)+0.55 length(train)+length(base)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0499                        text(length(train)+length(base)+0.45,0.125,<span class="string">'Split'</span>);
0500                    <span class="keyword">end</span>
0501                    
0502                    <span class="comment">%add washout bars</span>
0503                    <span class="keyword">for</span> w=1:length(wash)
0504                        <span class="keyword">if</span> w==1
0505                            fill([length(train)+length(base)+length(adapt)+0.45 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0506                            text(length(train)+length(base)+length(adapt)+0.45,0.125,<span class="string">'Wash'</span>);
0507                        <span class="keyword">else</span>
0508                            fill([length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0509                            text(length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45,0.125,<span class="string">'Wash'</span>);
0510                        <span class="keyword">end</span>
0511                    <span class="keyword">end</span>
0512                    
0513                    h = 1:1:length(meanhits1);
0514 <span class="comment">%                    h2 = 2:2:2*length(meanhits2);</span>
0515                    errorbar(h,meanhits1,stdhits1,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1.5);
0516 <span class="comment">%                    errorbar(h2,meanhits2,stdhits2,'k','LineWidth',1.5);</span>
0517                    plot([0 length(meanhits1)+1],[0.01 0.01],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0518                    plot([0 length(meanhits1)+1],[-0.01 -0.01],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);
0519                    <span class="comment">%     plot([0 2*length(meanhits1)+1],[nanmean(hits{z})+lqrs{z} nanmean(hits{z})+lqrs{z}]</span>
0520                    <span class="keyword">for</span> z = 1:length(h)
0521                        figure(5)
0522 <span class="comment">%                        subplot(2,1,1)</span>
0523                        bar(h(z),meanhits1(z),0.5,<span class="string">'FaceColor'</span>,color{z});<span class="comment">%color2(z,:));</span>
0524                    <span class="keyword">end</span>
0525                    ylim([-0.15 0.15]);
0526                    xlim([0 length(meanhits1)+0.5]);
0527                    title([this.subjectcode <span class="string">' Step Length Asymmetry Error'</span>]);
0528                    ylabel(<span class="string">'Error (m)'</span>);
0529                    
0530                    
0531 <span class="comment">%                    figure(5)</span>
0532 <span class="comment">%                    subplot(2,1,2)</span>
0533 <span class="comment">%                    hold on</span>
0534 <span class="comment">%                    fill([0 length(train)+0.5 length(train)+0.5 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0535 <span class="comment">%                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0536 <span class="comment">%</span>
0537 <span class="comment">%                    %add baseline bars</span>
0538 <span class="comment">%                    for b=1:2:length(base)</span>
0539 <span class="comment">%                        fill([length(train)+length(base(1:b))+0.45 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0540 <span class="comment">%                        text(length(train)+length(base(1:b))+0.45,0.125,'Base');</span>
0541 <span class="comment">%                    end</span>
0542 <span class="comment">%</span>
0543 <span class="comment">%                    %add adaptation bars</span>
0544 <span class="comment">%                    for a=1:2:length(adapt)</span>
0545 <span class="comment">%                        fill([length(train)+length(base)+length(adapt(1:a))+0.45 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0546 <span class="comment">%                        text(length(train)+length(base)+length(adapt(1:a))+0.45,0.125,'Split');</span>
0547 <span class="comment">%                    end</span>
0548 <span class="comment">%</span>
0549 <span class="comment">%                    %add washout bars</span>
0550 <span class="comment">%                    for w=1:2:length(wash)</span>
0551 <span class="comment">%                        fill([length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0552 <span class="comment">%                        text(length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45,0.125,'Wash');</span>
0553 <span class="comment">%                    end</span>
0554 <span class="comment">%</span>
0555 <span class="comment">%                    h = 1:1:length(meanlhits1);</span>
0556 <span class="comment">% %                    h2 = 2:2:2*length(meanlhits2);</span>
0557 <span class="comment">%                    errorbar(h,meanlhits1,stdlhits1,'k','LineWidth',1.5);</span>
0558 <span class="comment">% %                    errorbar(h2,meanlhits2,stdlhits2,'k','LineWidth',1.5);</span>
0559 <span class="comment">%                    plot([0 length(meanlhits1)+1],[0.0375 0.0375],'--k','LineWidth',2);%tolerance lines</span>
0560 <span class="comment">%                    plot([0 length(meanlhits1)+1],[-0.0375 -0.0375],'--k','LineWidth',2);</span>
0561 <span class="comment">%                    for z = 1:length(h)</span>
0562 <span class="comment">%                        figure(5)</span>
0563 <span class="comment">%                        subplot(2,1,2)</span>
0564 <span class="comment">%                        bar(h(z),meanlhits1(z),0.5,'FaceColor',color{z});</span>
0565 <span class="comment">%                    end</span>
0566 <span class="comment">%                    ylim([-0.15 0.15]);</span>
0567 <span class="comment">%                    xlim([0 length(meanhits1)+0.5]);</span>
0568 <span class="comment">%                    title([this.subjectcode ' Slow Leg Errors'])</span>
0569 <span class="comment">%                    ylabel('Error (m)');</span>
0570                    
0571                    
0572                    
0573                    
0574                    figure(6)<span class="comment">%plot of mean squared errors</span>
0575 <span class="comment">%                    subplot(2,1,1)</span>
0576                    hold on
0577                    fill([0 length(train)+0.5 length(train)+0.5 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0578                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0579                    
0580                    <span class="comment">%add baseline bars</span>
0581                    <span class="keyword">for</span> b=1<span class="comment">%:2:length(base)</span>
0582                        fill([length(train)+0.45 length(train)+0.55 length(train)+0.55 length(train)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0583                        text(length(train)+0.45,max(meanhits1.^2)+0.05*max(meanhits1.^2),<span class="string">'Base'</span>);
0584                    <span class="keyword">end</span>
0585                    
0586                    <span class="comment">%add adaptation bars</span>
0587                    <span class="keyword">for</span> a=1<span class="comment">%:2:length(adapt)</span>
0588                        fill([length(train)+length(base)+0.45 length(train)+length(base)+0.55 length(train)+length(base)+0.55 length(train)+length(base)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0589                        text(length(train)+length(base)+0.45,max(meanhits1.^2)+0.1*max(meanhits1.^2),<span class="string">'Split'</span>);
0590                    <span class="keyword">end</span>
0591                    
0592                    <span class="comment">%add washout bars</span>
0593                    <span class="keyword">for</span> w=1:length(wash)
0594                        <span class="keyword">if</span> w==1
0595                            fill([length(train)+length(base)+length(adapt)+0.45 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0596                            text(length(train)+length(base)+length(adapt)+0.45,0.125,<span class="string">'Wash'</span>);
0597                        <span class="keyword">else</span>
0598                            fill([length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);
0599                            text(length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45,0.125,<span class="string">'Wash'</span>);
0600                        <span class="keyword">end</span>
0601                    <span class="keyword">end</span>
0602                    
0603                    h = 1:1:length(meanhits1);
0604                    plot([0 length(meanhits1)+1],[0.0375 0.0375],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0605 <span class="comment">%                    plot([0 length(meanhits1)+1],[-0.0375 -0.0375],'--k','LineWidth',2);</span>
0606                    <span class="comment">%     plot([0 2*length(meanhits1)+1],[nanmean(hits{z})+lqrs{z} nanmean(hits{z})+lqrs{z}]</span>
0607                    <span class="keyword">for</span> z = 1:length(h)
0608                        figure(6)
0609 <span class="comment">%                        subplot(2,1,1)</span>
0610                        bar(h(z),meanhits1(z).^2,0.5,<span class="string">'FaceColor'</span>,color{z});<span class="comment">%color2(z,:));</span>
0611                    <span class="keyword">end</span>
0612                    ylim([0 max(meanhits1.^2)+0.1*max(meanhits1.^2)]);
0613                    xlim([0 length(meanhits1)+0.5]);
0614                    title([this.subjectcode <span class="string">' Step Length Asymmetry Error MSE'</span>]);
0615                    ylabel(<span class="string">'Error (m)'</span>);
0616                    
0617 <span class="comment">%                    figure(6)</span>
0618 <span class="comment">%                    subplot(2,1,2)</span>
0619 <span class="comment">%                    hold on</span>
0620 <span class="comment">%                    fill([0 length(train)+0.5 length(train)+0.5 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0621 <span class="comment">%                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);</span>
0622 <span class="comment">%</span>
0623 <span class="comment">%                    %add baseline bars</span>
0624 <span class="comment">%                    for b=1:2:length(base)</span>
0625 <span class="comment">%                        fill([length(train)+length(base(1:b))+0.45 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0626 <span class="comment">%                        text(length(train)+length(base(1:b))+0.45,max(meanlhits1.^2)+0.05*max(meanlhits1.^2),'Base');</span>
0627 <span class="comment">%                    end</span>
0628 <span class="comment">%</span>
0629 <span class="comment">%                    %add adaptation bars</span>
0630 <span class="comment">%                    for a=1:2:length(adapt)</span>
0631 <span class="comment">%                        fill([length(train)+length(base)+length(adapt(1:a))+0.45 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0632 <span class="comment">%                        text(length(train)+length(base)+length(adapt(1:a))+0.45,max(meanlhits1.^2)+0.05*max(meanlhits1.^2),'Split');</span>
0633 <span class="comment">%                    end</span>
0634 <span class="comment">%</span>
0635 <span class="comment">%                    %add washout bars</span>
0636 <span class="comment">%                    for w=1:2:length(wash)</span>
0637 <span class="comment">%                        fill([length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45],[0.1 0.1 -0.1 -0.1],[20 20 20]./256);</span>
0638 <span class="comment">%                        text(length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45,max(meanlhits1.^2)+0.05*max(meanlhits1.^2),'Wash');</span>
0639 <span class="comment">%                    end</span>
0640 <span class="comment">%</span>
0641 <span class="comment">%                    h = 1:1:length(meanlhits1);</span>
0642 <span class="comment">%                    plot([0 length(meanlhits1)+1],[0.0375 0.0375],'--k','LineWidth',2);%tolerance lines</span>
0643 <span class="comment">% %                    plot([0 length(meanlhits1)+1],[-0.0375 -0.0375],'--k','LineWidth',2);</span>
0644 <span class="comment">%                    for z = 1:length(h)</span>
0645 <span class="comment">%                        figure(6)</span>
0646 <span class="comment">%                        subplot(2,1,2)</span>
0647 <span class="comment">%                        bar(h(z),meanlhits1(z).^2,0.5,'FaceColor',color{z});</span>
0648 <span class="comment">%                    end</span>
0649 <span class="comment">%                    ylim([0 max(meanlhits1.^2)+0.1*max(meanlhits1.^2)]);</span>
0650 <span class="comment">%                    xlim([0 length(meanhits1)+0.5]);</span>
0651 <span class="comment">%                    title([this.subjectcode ' Slow Leg Errors'])</span>
0652 <span class="comment">%                    ylabel('Error (m)');</span>
0653                    
0654                    
0655                    figure(7)
0656 <span class="comment">%                    subplot(2,1,1)</span>
0657                    hold on
0658                    fill([0 length(train)+0.5 length(train)+0.5 0],[120 120 0 0],[230 230 230]./256);
0659                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[120 120 0 0],[230 230 230]./256);
0660                    <span class="comment">%add baseline bars</span>
0661                    <span class="keyword">for</span> b=1<span class="comment">%:2:length(base)</span>
0662                        fill([length(train)+0.45 length(train)+0.55 length(train)+0.55 length(train)+0.45],[100 100 0 0],[20 20 20]./256);
0663                        text(length(train)+0.45,105,<span class="string">'Base'</span>);
0664                    <span class="keyword">end</span>
0665                    <span class="comment">%add adaptation bars</span>
0666                    <span class="keyword">for</span> a=1<span class="comment">%:2:length(adapt)</span>
0667                        fill([length(train)+length(base)+0.45 length(train)+length(base)+0.55 length(train)+length(base)+0.55 length(train)+length(base)+0.45],[100 100 0 0],[20 20 20]./256);
0668                        text(length(train)+length(base)+0.45,105,<span class="string">'Split'</span>);
0669                    <span class="keyword">end</span>
0670                    <span class="comment">%add washout bars</span>
0671                    <span class="keyword">for</span> w=1:length(wash)
0672                        <span class="keyword">if</span> w==1
0673                            fill([length(train)+length(base)+length(adapt)+0.45 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.55 length(train)+length(base)+length(adapt)+0.45],[100 100 0 0],[20 20 20]./256);
0674                            text(length(train)+length(base)+length(adapt)+0.45,105,<span class="string">'Wash'</span>);
0675                        <span class="keyword">else</span>
0676                            fill([length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45],[100 100 0 0],[20 20 20]./256);
0677                            text(length(train)+length(base)+length(adapt)+length(wash(1:w-1))+0.45,105,<span class="string">'Wash'</span>);
0678                        <span class="keyword">end</span>
0679                    <span class="keyword">end</span>
0680                    plot([0 length(meanhits1)+1],[80 80],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0681                    plot([0 length(meanhits1)+1],[100 100],<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1);<span class="comment">%tolerance lines</span>
0682                    <span class="keyword">for</span> z=1:length(rscore)
0683                        bar(z,rscore(z)*100,0.5,<span class="string">'FaceColor'</span>,color{z});
0684                    <span class="keyword">end</span>
0685                    ylim([0 110]);
0686                    ylabel(<span class="string">'Accuracy (%)'</span>)
0687                    title([this.subjectcode <span class="string">' Step Length Asymmetry Error Accuracy'</span>])
0688                    
0689 <span class="comment">%                    subplot(2,1,2)</span>
0690 <span class="comment">%                    hold on</span>
0691 <span class="comment">%                    fill([0 length(train)+0.5 length(train)+0.5 0],[120 120 0 0],[230 230 230]./256);</span>
0692 <span class="comment">%                    fill([length(train)+0.5+length(base) length(train)+length(base)+length(adapt)+0.5 length(train)+length(base)+length(adapt)+0.5 length(train)+0.5+length(base)],[120 120 0 0],[230 230 230]./256);</span>
0693 <span class="comment">%                    %add baseline bars</span>
0694 <span class="comment">%                    for b=1:2:length(base)</span>
0695 <span class="comment">%                        fill([length(train)+length(base(1:b))+0.45 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.55 length(train)+length(base(1:b))+0.45],[100 100 0 0],[20 20 20]./256);</span>
0696 <span class="comment">%                        text(length(train)+length(base(1:b))+0.45,105,'Base');</span>
0697 <span class="comment">%                    end</span>
0698 <span class="comment">%                    %add adaptation bars</span>
0699 <span class="comment">%                    for a=1:2:length(adapt)</span>
0700 <span class="comment">%                        fill([length(train)+length(base)+length(adapt(1:a))+0.45 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.55 length(train)+length(base)+length(adapt(1:a))+0.45],[100 100 0 0],[20 20 20]./256);</span>
0701 <span class="comment">%                        text(length(train)+length(base)+length(adapt(1:a))+0.45,105,'Split');</span>
0702 <span class="comment">%                    end</span>
0703 <span class="comment">%                    %add washout bars</span>
0704 <span class="comment">%                    for w=1:2:length(wash)</span>
0705 <span class="comment">%                        fill([length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.55 length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45],[100 100 0 0],[20 20 20]./256);</span>
0706 <span class="comment">%                        text(length(train)+length(base)+length(adapt)+length(wash(1:w))+0.45,105,'Wash');</span>
0707 <span class="comment">%                    end</span>
0708 <span class="comment">%                    plot([0 length(meanlhits1)+1],[80 80],'--k','LineWidth',2);%tolerance lines</span>
0709 <span class="comment">%                    plot([0 length(meanlhits1)+1],[100 100],'k','LineWidth',1);%tolerance lines</span>
0710 <span class="comment">%                    for z=1:length(lscore)</span>
0711 <span class="comment">%                        bar(z,lscore(z)*100,0.5,'FaceColor',color{z});</span>
0712 <span class="comment">%                    end</span>
0713 <span class="comment">%                    ylim([0 110]);</span>
0714 <span class="comment">%                    ylabel('Accuracy (%)')</span>
0715 <span class="comment">%                    title([this.subjectcode ' Slow Leg Accuracy'])</span>
0716 
0717 
0718                     figure(8)
0719                     hold on
0720 <span class="comment">%                    keyboard</span>
0721                    fill([0 length(cell2mat(hits(train)')) length(cell2mat(hits(train)')) 0],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0722                    fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')) length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))],[0.255 0.255 -0.255 -0.255],[230 230 230]./256);
0723 
0724                    <span class="comment">%add baseline walking bars</span>
0725                    <span class="keyword">for</span> b=1<span class="comment">%:length(base)</span>
0726                        fill([length(cell2mat(hits(train)'))-0.5 length(cell2mat(hits(train)'))+0.5 length(cell2mat(hits(train)'))+0.5 length(cell2mat(hits(train)'))-0.5],[0.075 0.075 -0.075 -0.075],[20 20 20]./256);
0727                        text(length(cell2mat(hits(train)')),0.09,<span class="string">'Base'</span>);
0728                    <span class="keyword">end</span>
0729 
0730                    <span class="comment">%add adaptation walking bars</span>
0731                    <span class="keyword">for</span> a=1<span class="comment">%:2:length(adapt)</span>
0732                        fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))-0.5],[0.075 0.075 -0.075 -0.075],[20 20 20]./256);
0733                        text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)')),0.09,<span class="string">'Split'</span>);
0734                    <span class="keyword">end</span>
0735 
0736                    <span class="comment">%add washout walking bars</span>
0737                    <span class="keyword">for</span> w=1:length(wash)
0738                        <span class="keyword">if</span> w==1
0739                            fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))-0.5],[0.075 0.075 -0.075 -0.075],[20 20 20]./256);
0740                            text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)')),0.09,<span class="string">'Wash'</span>);
0741                        <span class="keyword">else</span>
0742                            fill([length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))-0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))+0.5 length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))'))-0.5],[0.075 0.075 -0.075 -0.075],[20 20 20]./256);
0743                            text(length(cell2mat(hits(train)'))+length(cell2mat(hits(base)'))+length(cell2mat(hits(adapt)'))+length(cell2mat(hits(wash(1:w-1))')),0.09,<span class="string">'Wash'</span>);
0744                        <span class="keyword">end</span>
0745                    <span class="keyword">end</span>
0746 
0747 
0748                    h = 0;
0749                    <span class="keyword">for</span> z = 1:length(filename)
0750                        figure(8)
0751 <span class="comment">%                        subplot(2,1,1)</span>
0752                        hold on
0753                        scatter([1:length(anks{z})]+h,anks{z},75,color{z},<span class="string">'fill'</span>);
0754                        plot([h h+length(anks{z})],[0.01 0.01],<span class="string">'k'</span>);<span class="comment">%tolerance lines</span>
0755                        plot([h h+length(anks{z})],[-0.01 -0.01],<span class="string">'k'</span>);
0756 <span class="comment">%                        plot([h h+length(anks{z})],[nanmean(anks{z})+lqrs{z}/2 nanmean(anks{z})+lqrs{z}/2],'Color',[0.5 0 0.5],'LineWidth',2);%tolerance lines</span>
0757 <span class="comment">%                        plot([h h+length(anks{z})],[nanmean(anks{z})-lqrs{z}/2 nanmean(anks{z})-lqrs{z}/2],'Color',[0.5 0 0.5],'LineWidth',2);%tolerance lines</span>
0758                        h = h+length(anks{z});
0759                    <span class="keyword">end</span>
0760                    figure(8)
0761 <span class="comment">%                    subplot(2,1,1)</span>
0762                    ylim([-0.1 0.1]);
0763                    xlim([0 h+10]);
0764                    title([this.subjectcode <span class="string">' Ankle Separation pre-step'</span>]);
0765                    xlabel(<span class="string">'step #'</span>);
0766                    ylabel(<span class="string">'Error (m)'</span>);
0767                     
0768                    
0769                <span class="keyword">end</span>
0770             <span class="keyword">end</span>
0771         <span class="keyword">end</span>
0772         
0773         <a name="_sub2" href="#_subfunctions" class="code">function []=editTriallist(this)</a>
0774             <span class="keyword">global</span> t
0775             <span class="keyword">global</span> ID
0776             ID = this.subjectcode;
0777 
0778             <span class="keyword">if</span> isempty(this.triallist)<span class="comment">%if triallist is empty, start from scratch</span>
0779                 [filenames,~] = uigetfiles(<span class="string">'*.*'</span>,<span class="string">'Select filenames'</span>);
0780                 this.data = cell(length(filenames),1);
0781                 <span class="keyword">if</span> iscell(filenames)
0782                     f = figure;
0783                     data = cell(length(filenames),4);
0784                     data(:,1)=filenames;
0785                     
0786                     <span class="keyword">for</span> z=1:length(filenames)<span class="comment">%autodetect if a trial was a train for evaluation</span>
0787                         tname = filenames{z};
0788                         <span class="keyword">if</span> strcmp(tname(end-5:end-4),<span class="string">'V2'</span>) || strcmp(tname(end-5:end-4),<span class="string">'V3'</span>)
0789                             data{z,3} = <span class="string">'train'</span>;
0790                         <span class="keyword">else</span>
0791                             data{z,3} = <span class="string">'eval'</span>;
0792                         <span class="keyword">end</span>
0793                     <span class="keyword">end</span>
0794                     
0795                     colnames = {<span class="string">'Filename'</span>,<span class="string">'#'</span>,<span class="string">'type'</span>,<span class="string">'category'</span>};
0796                     columnformat = {<span class="string">'char'</span>,<span class="string">'numeric'</span>,{<span class="string">'train'</span>,<span class="string">'eval'</span>},{<span class="string">'training'</span>,<span class="string">'baseline'</span>,<span class="string">'post-adaptation'</span>,<span class="string">'washout'</span>}};
0797                     t=uitable(f,<span class="string">'Position'</span>,[10,10,375,375],<span class="string">'Data'</span>,data,<span class="string">'ColumnName'</span>,colnames,<span class="string">'ColumnFormat'</span>,columnformat,<span class="string">'ColumnEditable'</span>,[true true true true]);
0798                     set(t,<span class="string">'celleditcallback'</span>,<span class="string">'global ID;global t;temp = get(t,''Data'');eval([ID ''.triallist = temp;'']);'</span>);
0799                     set(t,<span class="string">'DeleteFcn'</span>,<span class="string">'global ID;eval([ID ''.saveit()'']);'</span>);
0800                 <span class="keyword">else</span>
0801                     f = figure;
0802                     data = cell(1,4);
0803                     data(1,1) = filenames;
0804                     <span class="keyword">if</span> strcmp(filenames(end-5:end-4),<span class="string">'V2'</span>)
0805                         data(1,3) = <span class="string">'train'</span>;
0806                     <span class="keyword">else</span>
0807                         data(1,3) = <span class="string">'eval'</span>;
0808                     <span class="keyword">end</span>
0809                     colnames = {<span class="string">'Filename'</span>,<span class="string">'#'</span>,<span class="string">'type'</span>,<span class="string">'category'</span>};
0810                     columnformat = {<span class="string">'char'</span>,<span class="string">'numeric'</span>,{<span class="string">'train'</span>,<span class="string">'eval'</span>},{<span class="string">'training'</span>,<span class="string">'baseline'</span>,<span class="string">'post-adaptation'</span>,<span class="string">'washout'</span>}};
0811                     t=uitable(f,<span class="string">'Position'</span>,[10,10,375,375],<span class="string">'Data'</span>,data,<span class="string">'ColumnName'</span>,colnames,<span class="string">'ColumnFormat'</span>,columnformat,<span class="string">'ColumnEditable'</span>,[true true true true]);
0812                     set(t,<span class="string">'celleditcallback'</span>,<span class="string">'global ID;global t;temp = get(t,''Data'');eval([ID ''.triallist = temp;'']);'</span>);
0813                     set(t,<span class="string">'DeleteFcn'</span>,<span class="string">'global ID;eval([ID ''.saveit()'']);'</span>);
0814                 <span class="keyword">end</span>
0815                 
0816             <span class="keyword">else</span> <span class="comment">%if triallist is already populated, just edit what is already there</span>
0817                 [filenames,~] = uigetfiles(<span class="string">'*.*'</span>,<span class="string">'Select filenames'</span>);
0818                 this.data = cell(length(filenames),1);
0819                 <span class="keyword">if</span> iscell(filenames)
0820                     f = figure;
0821                     data = cell(length(filenames),4);
0822                     data(:,1)=filenames;
0823                     data(:,2:4) = this.triallist(:,2:4);
0824                     colnames = {<span class="string">'Filename'</span>,<span class="string">'#'</span>,<span class="string">'type'</span>,<span class="string">'category'</span>};
0825                     columnformat = {<span class="string">'char'</span>,<span class="string">'numeric'</span>,{<span class="string">'train'</span>,<span class="string">'eval'</span>},{<span class="string">'training'</span>,<span class="string">'baseline'</span>,<span class="string">'post-adaptation'</span>,<span class="string">'washout'</span>}};
0826                     t=uitable(f,<span class="string">'Position'</span>,[10,10,375,375],<span class="string">'Data'</span>,data,<span class="string">'ColumnName'</span>,colnames,<span class="string">'ColumnFormat'</span>,columnformat,<span class="string">'ColumnEditable'</span>,[true true true true]);
0827                     set(t,<span class="string">'celleditcallback'</span>,<span class="string">'global ID;global t;temp = get(t,''Data'');eval([ID ''.triallist = temp;'']);'</span>);
0828                     set(t,<span class="string">'DeleteFcn'</span>,<span class="string">'global ID;eval([ID ''.saveit()'']);'</span>);
0829                 <span class="keyword">else</span>
0830                     f = figure;
0831                     data = cell(1,4);
0832                     data(1,1) = filenames;
0833                     data(1,2:4) = this.triallist(1,2:4);
0834                     colnames = {<span class="string">'Filename'</span>,<span class="string">'#'</span>,<span class="string">'type'</span>,<span class="string">'category'</span>};
0835                     columnformat = {<span class="string">'char'</span>,<span class="string">'numeric'</span>,{<span class="string">'train'</span>,<span class="string">'eval'</span>},{<span class="string">'training'</span>,<span class="string">'baseline'</span>,<span class="string">'post-adaptation'</span>,<span class="string">'washout'</span>}};
0836                     t=uitable(f,<span class="string">'Position'</span>,[10,10,375,375],<span class="string">'Data'</span>,data,<span class="string">'ColumnName'</span>,colnames,<span class="string">'ColumnFormat'</span>,columnformat,<span class="string">'ColumnEditable'</span>,[true true true true]);
0837                     set(t,<span class="string">'celleditcallback'</span>,<span class="string">'global ID;global t;temp = get(t,''Data'');eval([ID ''.triallist = temp;'']);'</span>);
0838                     set(t,<span class="string">'DeleteFcn'</span>,<span class="string">'global ID;eval([ID ''.saveit()'']);'</span>);
0839                 <span class="keyword">end</span>
0840                 
0841             <span class="keyword">end</span>
0842         <span class="keyword">end</span>
0843         
0844         <a name="_sub3" href="#_subfunctions" class="code">function []=saveit(this)</a><span class="comment">%save instance as the &quot;subjectcode_SLBF&quot;</span>
0845             
0846             <span class="keyword">if</span> isempty(this.subjectcode)
0847                 cprintf(<span class="string">'err'</span>,<span class="string">'WARNING: save failed, no valid ID present'</span>);
0848             <span class="keyword">else</span>
0849                 savename = [this.subjectcode <span class="string">'_VazE2B_day'</span> num2str(this.day) <span class="string">'.mat'</span>];
0850                 eval([this.subjectcode <span class="string">'=this;'</span>]);
0851                 save(savename,this.subjectcode);
0852             <span class="keyword">end</span>
0853         <span class="keyword">end</span>
0854         
0855         <a name="_sub4" href="#_subfunctions" class="code">function []=comparedays(this,flag)</a>
0856             <span class="comment">%make bar plots of day1 and day2 means to compare performances</span>
0857             <span class="comment">%no inputs required, data is located from a uitable</span>
0858             <span class="comment">%</span>
0859             <span class="comment">%creates figures of bar plots for fast and slow legs, day 1 and</span>
0860             <span class="comment">%day 2</span>
0861             <span class="comment">%</span>
0862             <span class="comment">%flag indicates whether to normalize data by last training</span>
0863             <span class="comment">%phase evaluation, 0 for no, 1 for yes</span>
0864             <span class="comment">%</span>
0865             <span class="comment">%use a uitable to assign the locations of each Results.mat</span>
0866             <span class="comment">%file, should be 4 of them, 2 per day</span>
0867 
0868             [file1,path1] = uigetfile(<span class="string">'*.*'</span>,<span class="string">'Select Day 1 File'</span>);
0869             [file2,path2] = uigetfile(<span class="string">'*.*'</span>,<span class="string">'Select Day 2 File'</span>);
0870             
0871             <span class="comment">%deal with day 1</span>
0872             load([path1,<span class="string">'Results.mat'</span>]);
0873             tlist1 = this.triallist;<span class="comment">% must be day1 instance loaded as this</span>
0874             <span class="keyword">if</span> strcmp(this.dominantleg,<span class="string">'R'</span>)
0875                 fast1 = hits;
0876                 slow1 = lhits;
0877             <span class="keyword">else</span>
0878                 fast1 = lhits;
0879                 slow1 = hits;
0880             <span class="keyword">end</span>
0881             
0882             clear hits lhits
0883             
0884             load([path2,<span class="string">'Results.mat'</span>]);
0885             load([path2,file2]);<span class="comment">%make sure this is the day2 instance otherwise will probably crash</span>
0886             file3 = [file2(1:6) file2(end-8:end-4)];
0887             eval([<span class="string">'tlist2 = '</span> file3 <span class="string">'.triallist;'</span>]);
0888             <span class="keyword">if</span> strcmp(this.dominantleg,<span class="string">'R'</span>)
0889                 fast2 = hits;
0890                 slow2 = lhits;
0891             <span class="keyword">else</span>
0892                 fast2 = lhits;
0893                 slow2 = hits;
0894             <span class="keyword">end</span>
0895             clear hits lhits
0896             
0897             <span class="keyword">if</span> length(tlist1)==length(tlist2)
0898                 train = find(strcmp(tlist1(:,4),<span class="string">'training'</span>));<span class="comment">%logicals of where training trials are</span>
0899                 base = find(strcmp(tlist1(:,4),<span class="string">'baseline'</span>));
0900                 adapt = find(strcmp(tlist1(:,4),<span class="string">'adaptation'</span>));
0901                 wash = find(strcmp(tlist1(:,4),<span class="string">'washout'</span>));
0902                 
0903                 colors1 = cell(length(tlist1),1);
0904                 colors2 = cell(length(tlist1),1);
0905                 <span class="keyword">for</span> z=1:length(tlist1)
0906                    <span class="keyword">if</span> strcmp(<span class="string">'train'</span>,tlist1(z,3))
0907                        colors1{z}=[0 102/256 204/256];
0908                        colors2{z}=[0 1 1];
0909                    <span class="keyword">else</span>
0910                        colors1{z}=[1 0 0];
0911                        colors2{z}=[1 128/256 0];
0912                    <span class="keyword">end</span>
0913                 <span class="keyword">end</span>
0914                 
0915                 <span class="keyword">for</span> z=1:length(fast1)
0916                     temp1 = fast1{z};
0917                     temp2 = fast2{z};
0918                     temp1(abs(temp1) &gt; 0.1) = [];
0919                     temp2(abs(temp2) &gt; 0.1) = [];
0920                     <span class="keyword">if</span> flag<span class="comment">%normalize</span>
0921                         temp1 = (temp1-mean(fast1{length(train)}))./abs(mean(fast1{length(train)}))*100;
0922                         temp2 = (temp2-mean(fast2{length(train)}))./abs(mean(fast2{length(train)}))*100;
0923                     <span class="keyword">end</span>
0924                     meanfast1(z) = mean(temp1);
0925                     meanfast2(z) = mean(temp2);
0926                     stdfast1(z) = std(temp1);
0927                     stdfast2(z) = std(temp2);
0928                 <span class="keyword">end</span>
0929                 
0930                 <span class="keyword">for</span> z=1:length(slow1)
0931                     temp1 = slow1{z};
0932                     temp2 = slow2{z};
0933                     temp1(abs(temp1) &gt; 0.1) = [];
0934                     temp2(abs(temp2) &gt; 0.1) = [];
0935                     <span class="keyword">if</span> flag<span class="comment">%normalize</span>
0936                         temp1 = (temp1-mean(slow1{length(train)}))./abs(mean(slow1{length(train)}))*100;
0937                         temp2 = (temp2-mean(slow2{length(train)}))./abs(mean(slow2{length(train)}))*100;
0938                     <span class="keyword">end</span>
0939                     meanslow1(z) = mean(temp1);
0940                     meanslow2(z) = mean(temp2);
0941                     stdslow1(z) = std(temp1);
0942                     stdslow2(z) = std(temp2);
0943                 <span class="keyword">end</span>
0944                 
0945                 hand = zeros(4,1);
0946                 <span class="comment">%fast leg</span>
0947                 figure(7)
0948                 subplot(2,1,1)
0949                 hold on
0950                 fill([0 2*length(train)+0.5 2*length(train)+0.5 0],[max([meanfast1 meanfast2])+1000 max([meanfast1 meanfast2])+1000 -1*max([meanfast1 meanfast2])-1000 -1*max([meanfast1 meanfast2])-1000],[230 230 230]./256);
0951                 fill([2*length(train)+0.5+2*length(base) 2*length(train)+2*length(base)+2*length(adapt)+0.5 2*length(train)+2*length(base)+2*length(adapt)+0.5 2*length(train)+0.5+2*length(base)],[max([meanfast1 meanfast2])+1000 max([meanfast1 meanfast2])+1000 -1*max([meanfast1 meanfast2])-1000 -1*max([meanfast1 meanfast2])-1000],[230 230 230]./256);
0952                 h = 1:2:2*length(meanfast1);
0953                 h2 = 1.5:2:2*length(meanfast2);
0954 <span class="comment">%                 plot([0 2*length(meanfast1)+1],[0.0375 0.0375],'--k','LineWidth',2);%tolerance lines</span>
0955 <span class="comment">%                 plot([0 2*length(meanfast1)+1],[-0.0375 -0.0375],'--k','LineWidth',2);</span>
0956 <span class="comment">%                 keyboard</span>
0957                 <span class="keyword">for</span> z = 1:2:length(h)<span class="comment">%trainings</span>
0958 <span class="comment">%                     figure(7)</span>
0959                     hand(1) = bar(h(z),meanfast1(z),0.5,<span class="string">'FaceColor'</span>,colors1{z});
0960                 <span class="keyword">end</span>
0961                 <span class="keyword">for</span> z = 2:2:length(h)<span class="comment">%evaluations</span>
0962 <span class="comment">%                     figure(7)</span>
0963                     hand(2) = bar(h(z),meanfast1(z),0.5,<span class="string">'FaceColor'</span>,colors1{z});
0964                 <span class="keyword">end</span>
0965                 <span class="keyword">for</span> z=1:2:length(h2)
0966 <span class="comment">%                     figure(7)</span>
0967                     hand(3) = bar(h2(z),meanfast2(z),0.5,<span class="string">'FaceColor'</span>,colors2{z});
0968                 <span class="keyword">end</span>
0969                 <span class="keyword">for</span> z=2:2:length(h2)
0970 <span class="comment">%                     figure(7)</span>
0971                     hand(4) = bar(h2(z),meanfast2(z),0.5,<span class="string">'FaceColor'</span>,colors2{z});
0972                 <span class="keyword">end</span>
0973                 <span class="keyword">if</span> ~flag
0974                     errorbar(h,meanfast1,stdfast1,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1.5);
0975                     errorbar(h2,meanfast2,stdfast2,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1.5);
0976                     plot([0 2*length(meanfast1)+1],[0.0375 0.0375],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
0977                     plot([0 2*length(meanfast1)+1],[-0.0375 -0.0375],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);
0978                     ylim([-1*max([meanfast1 meanfast2 stdfast1 stdfast2])-0.05 max([meanfast1 meanfast2 stdfast1 stdfast2])+0.05]);
0979                 <span class="keyword">else</span>
0980                     ylim([-1*abs(min([meanfast1 meanfast2]))-50 max([meanfast1 meanfast2])+50]);
0981                 <span class="keyword">end</span>
0982                 title([this.subjectcode <span class="string">' Fast Leg Day 1 vs. Day 2 Errors'</span>]);
0983                 ylabel(<span class="string">'% Error from Baseline'</span>);
0984                 legend(hand,<span class="string">'train D1'</span>,<span class="string">'eval D1'</span>,<span class="string">'train D2'</span>,<span class="string">'eval D2'</span>)
0985 <span class="comment">%                 keyboard</span>
0986 
0987 <span class="comment">%                 figure(7)</span>
0988                 subplot(2,1,2)
0989                 hold on
0990                 fill([0 2*length(train)+0.5 2*length(train)+0.5 0],[max([meanslow1 meanslow2])+1000 max([meanslow1 meanslow2])+1000 -1*max([meanslow1 meanslow2])-1000 -1*max([meanslow1 meanslow2])-1000],[230 230 230]./256);
0991                 fill([2*length(train)+0.5+2*length(base) 2*length(train)+2*length(base)+2*length(adapt)+0.5 2*length(train)+2*length(base)+2*length(adapt)+0.5 2*length(train)+0.5+2*length(base)],[max([meanslow1 meanslow2])+1000 max([meanslow1 meanslow2])+1000 -1*max([meanslow1 meanslow2])-1000 -1*max([meanslow1 meanslow2])-1000],[230 230 230]./256);
0992                 h = 1:2:2*length(meanslow1);
0993                 h2 = 1.5:2:2*length(meanslow2);
0994 <span class="comment">%                 plot([0 2*length(meanslow1)+1],[0.0375 0.0375],'--k','LineWidth',2);%tolerance lines</span>
0995 <span class="comment">%                 plot([0 2*length(meanslow1)+1],[-0.0375 -0.0375],'--k','LineWidth',2);</span>
0996                 <span class="keyword">for</span> z = 1:2:length(h)<span class="comment">%trainings</span>
0997 <span class="comment">%                     figure(8)</span>
0998                     hand(1) = bar(h(z),meanslow1(z),0.5,<span class="string">'FaceColor'</span>,colors1{z});
0999                 <span class="keyword">end</span>
1000                 <span class="keyword">for</span> z = 2:2:length(h)<span class="comment">%evaluations</span>
1001 <span class="comment">%                     figure(8)</span>
1002                     hand(2) = bar(h(z),meanslow1(z),0.5,<span class="string">'FaceColor'</span>,colors1{z});
1003                 <span class="keyword">end</span>
1004                 <span class="keyword">for</span> z=1:2:length(h2)
1005 <span class="comment">%                     figure(8)</span>
1006                     hand(3) = bar(h2(z),meanslow2(z),0.5,<span class="string">'FaceColor'</span>,colors2{z});
1007                 <span class="keyword">end</span>
1008                 <span class="keyword">for</span> z=2:2:length(h2)
1009 <span class="comment">%                     figure(8)</span>
1010                     hand(4) = bar(h2(z),meanslow2(z),0.5,<span class="string">'FaceColor'</span>,colors2{z});
1011                 <span class="keyword">end</span>
1012                 <span class="keyword">if</span> ~flag
1013                     errorbar(h,meanslow1,stdslow1,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1.5);
1014                     errorbar(h2,meanslow2,stdslow2,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1.5);
1015                     plot([0 2*length(meanslow1)+1],[0.0375 0.0375],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);<span class="comment">%tolerance lines</span>
1016                     plot([0 2*length(meanslow1)+1],[-0.0375 -0.0375],<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);
1017                     ylim([-1*max([meanslow1 meanslow2 stdslow1 stdslow2])-0.05 max([meanslow1 meanslow2 stdslow1 stdslow2])+0.05]);
1018                 <span class="keyword">else</span>
1019                     ylim([-1*abs(min([meanslow1 meanslow2]))-50 max([meanslow1 meanslow2])+50]);
1020                 <span class="keyword">end</span>
1021                 title([this.subjectcode <span class="string">' Slow Leg Day 1 vs. Day 2 Errors'</span>]);
1022                 ylabel(<span class="string">'% Error from Baseline'</span>);
1023                 legend(hand,<span class="string">'train D1'</span>,<span class="string">'eval D1'</span>,<span class="string">'train D2'</span>,<span class="string">'eval D2'</span>)
1024 
1025                             <span class="keyword">end</span>
1026             
1027 <span class="comment">%             keyboard</span>
1028             
1029         <span class="keyword">end</span>
1030             
1031     <span class="keyword">end</span>
1032     
1033 <span class="keyword">end</span>
1034</pre></div>
<hr><address>Generated on Tue 08-Mar-2016 13:39:40 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>